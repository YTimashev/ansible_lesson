# Домашнее задание к занятию 17 «Инцидент-менеджмент»

## Задание

Составьте постмортем на основе реального сбоя системы GitHub в 2018 году.

Информацию о сбое можно изучить по ссылкам ниже:

* [краткое описание на русском языке](https://habr.com/ru/post/427301/);
* [развёрнутое описание на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/). [Перевод на русский язык](https://habr.com/ru/articles/428409/)


## Выполнение задания
## Постмотрем

Раздел | Сбой системы GitHub 21 октября 2018
   --- | ---
Краткое описание инцидента | 21.10.2018 в 22:52 (UTC). После непродолжительной потери связи между сетевым узлом и датацентром произошел сбой базы данных, что привело к несогласованности информации, представленной на сервисе.
Предшествующие события     | 21 октября в 22:52 (UTC). Плановые работы по замене вышедшего из строя 100G оптического оборудования в дата-центре на восточном побережье США
Причина инцидента          | Кратковременное отсутствие связи между датацентрами на восточном побережье США. 
Воздействие                | Отображение устаревшей и непоследовательной информации по причине  нарушений целостности данных в MySQL и в работе отдельных сервисов. 
Обнаружение                | 21 октября в 23:02 (UTC). Инцидент был замечен дежурными инженерами через оповещения системы мониторинга
Реакция                    | Связь между датацентрами была востановлена довольно быстро (43 секунды), однако этого времени хватило на накопление нарушений целостности БД. В связи с чем первую очередь была отключена часть сервисов для минимизации изменений БД, На полное востановление целостности данных, было затрачено 24 часа 11 минут.
Восстановление             | Произведено востановление данных из резервных копий, добавление накопленных. Возврат к стабильной топологии обслуживания. Возобновленаие обработки заданий в очереди- времнное подключение дополнительных реплик на чтение. Подключение отключенных сервисов. 
Таймлайн                   | **21 октября 2018, 22:52 UTC** - Нарушение связи между сетевым узлом и основным дата-центром на восточном побережье США<br> **21 октября 2018, 22:52 UTC** - Оркестратор в основном дата-центре запустил процесс выбора нового лидера, в результате чего начал создавать топологию кластера БД на западе. После восстановления подключения, приложения направили трафик по записи на сервера на западе. В следствие чего на серверах образовались различные данные, без возможности передачи новых данных на первичный сервер на востоке<br> **21 октября 2018, 22:54 UTC** - Внутренние системы мониторинга начали генерировать оповещения о многочисленных сбоях в работе систем<br> **21 октября 2018, 23:02 UTC** - Инженеры определили, что топологии для многочисленных кластеров БД находятся в неожиданном состоянии - при запросе API Оркестратора отображалась топология репликации БД, содержащая только серверы из западного ЦОД.<br> **21 октября 2018, 23:07 UTC** - Инженеры вручную заблокировали внутренние средства развёртывания, чем предотвратили внесение дополнительных изменений в БД<br> **21 октября 2018, 23:09 UTC** - Группа реагирования установила статус активного инцидента (желтый) работоспособности сайта ()<br> **21 октября 2018, 23:11 UTC** - Координатор присоединился к работе и через две минуты принял решение изменить статус сайта на красный.<Br> **21 октября 2018, 23:13 UTC** - Были привлечены разработчики из инженерной группы БД, которые исследовали текущее состояние для определения необходимых действий для ручной настройки БД<br> **21 октября 2018, 23:19 UTC** - В целях сохранности данных принято решение об остановке выполнения заданий, которые пишут метаданные типа пуш-запросов<br> **22 октября 2018, 00:05 UTC** - Инженеры из группы реагирования начали разработали план устранения несогласованности данных и запустили процедуры отработки отказа для MySQL<br> **22 октября 2018, 00:41 UTC** - Инициирован процесс резервного копирования для всех затронутых кластеров MySQL. Одновременно несколько групп инженеров изучали способы ускорения передачи и восстановления данных без дальнейшей деградации сайта и риска повреждения данных<br> **22 октября 2018, 06:51 UTC** - Несколько кластеров на востоке завершили восстановление из резервных копий и начали реплицировать новые данные с Западного побережья<br> **22 октября 2018, 07:46 UTC** - Публикация информационного сообщение об инциденте<br> **22 октября 2018, 11:12 UTC** - Все первичные БД вновь переведены на Восток, не смотря на возросшую производительность сайта отдельные данные отставали на несколько часов из-за отложенных реплик<br> **22 октября 2018, 13:15 UTC** - Время отставания репликации до согласованного состояния увеличивалось, в связи с чем была произведена подготовка дополнительных реплик чтения MySQL в общедоступном облаке Восточного побережья<br> **22 октября 2018, 16:24 UTC** - Завершение синхронизация реплик - возврат к исходной топологии. Устранены проблемы задержки и доступности. Сохранение красного статуса по причине дальнейшей обработки накопленных данных.<br> **22 октяюря 2018, 16:45 UTC** - Подключение всех деактивированных функций/сервисов. Корректировка TTL истекших за время восстановления задач. <br> **22 октября 2018, 23:03 UTC** - Обработка всех незавершённых событий и сборок. Подтверждение целостности и правильной работы всех систем. Измение статуса сайта на зелёный
Последующие действия       | Настройка конфигурации Orchestrator, для предотвращения повторения произошедшего инцидента. Введение системной практики проверки сценариев сбоев, для предупреждения их возникновения в реальности (**Chaos Engineering**)

---